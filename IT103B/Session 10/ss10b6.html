<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const players = [
            { name: "Messi", position: "Forward", age: 36, goals: 25, assists: 15, matches: 34, yellowCards: 2 },
            { name: "Ronaldo", position: "Forward", age: 39, goals: 30, assists: 10, matches: 38, yellowCards: 4 },
            { name: "Neymar", position: "Forward", age: 32, goals: 18, assists: 20, matches: 32, yellowCards: 3 },
            { name: "De Bruyne", position: "Midfielder", age: 33, goals: 8, assists: 25, matches: 35, yellowCards: 1 },
            { name: "Kante", position: "Midfielder", age: 33, goals: 2, assists: 6, matches: 36, yellowCards: 0 },
            { name: "Van Dijk", position: "Defender", age: 33, goals: 5, assists: 3, matches: 33, yellowCards: 2 },
            { name: "Alisson", position: "Goalkeeper", age: 31, goals: 0, assists: 1, matches: 37, yellowCards: 0 }
        ];

        function generateRankingReport(minMatches, teamPlayers) {

            const qualified = teamPlayers
                .filter(p => p.matches >= minMatches)
                .map((p, index) => {

                    const performanceScore = Number(((p.goals + p.assists) / p.matches).toFixed(2));

                    const efficiencyScore = Number(
                        (performanceScore - (p.yellowCards / p.matches) * 10).toFixed(2)
                    );

                    return {
                        ...p,
                        performanceScore,
                        efficiencyScore,
                        index
                    };
                });

            const ranked = qualified.sort((a, b) => {

                if (b.efficiencyScore !== a.efficiencyScore) {
                    return b.efficiencyScore - a.efficiencyScore;
                }

                if (b.performanceScore !== a.performanceScore) {
                    return b.performanceScore - a.performanceScore;
                }

                if (b.goals !== a.goals) {
                    return b.goals - a.goals;
                }

                return a.index - b.index;
            });

            console.log("XẾP HẠNG ĐỘI BÓNG (từ minMatches trở lên)");

            ranked.forEach((p, i) => {
                console.log(
                    `${i + 1}. ${p.name} - Efficiency: ${p.efficiencyScore} | Performance: ${p.performanceScore} | Goals: ${p.goals}`
                );
            });

            console.log("");
            console.log("Tổng số cầu thủ xếp hạng:", ranked.length);

            if (ranked.length > 0) {

                console.log("Cầu thủ xuất sắc nhất:", ranked[0].name);

                const avgEfficiency =
                    ranked.reduce((sum, p) => sum + p.efficiencyScore, 0) / ranked.length;

                console.log("Trung bình efficiency top 3:", avgEfficiency.toFixed(2));
            }
        }

        generateRankingReport(30, players);
    </script>
</body>

</html>